<Window x:Class="AccountingSystem.WPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="النظام المحاسبي الشامل - لوحة التحكم الذكية" 
        Height="1000" Width="1800" 
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        FlowDirection="RightToLeft"
        FontFamily="Segoe UI, Tahoma"
        FontSize="14"
        UseLayoutRounding="True"
        SnapsToDevicePixels="True"
        TextOptions.TextFormattingMode="Ideal"
        TextOptions.TextRenderingMode="Auto"
        Background="#F8F9FA"
        Loaded="MainWindow_Loaded">

    <Window.InputBindings>
        <!-- اختصارات لوحة المفاتيح للتنقل السريع -->
        <KeyBinding Key="F1" Command="{Binding SidebarViewModel.HomeCommand}"/>
        <KeyBinding Key="F2" Command="{Binding SidebarViewModel.NewSalesInvoiceCommand}"/>
        <KeyBinding Key="F3" Command="{Binding SidebarViewModel.NewPurchaseInvoiceCommand}"/>
        <KeyBinding Key="F5" Command="{Binding SidebarViewModel.CustomersCommand}"/>
        <KeyBinding Key="F6" Command="{Binding SidebarViewModel.SuppliersCommand}"/>
        <KeyBinding Key="F7" Command="{Binding SidebarViewModel.ProductsCommand}"/>
        <KeyBinding Key="F8" Command="{Binding SidebarViewModel.InventoryCommand}"/>
        <KeyBinding Key="F9" Command="{Binding SidebarViewModel.ReportsCommand}"/>
        <KeyBinding Key="F11" Command="{Binding SidebarViewModel.SettingsCommand}"/>
        
        <!-- اختصارات متقدمة -->
        <KeyBinding Modifiers="Ctrl+Alt" Key="C" Command="{Binding SidebarViewModel.CustomersCommand}"/>
        <KeyBinding Modifiers="Ctrl+Alt" Key="S" Command="{Binding SidebarViewModel.SuppliersCommand}"/>
        <KeyBinding Modifiers="Ctrl+Alt" Key="P" Command="{Binding SidebarViewModel.ProductsCommand}"/>
        <KeyBinding Modifiers="Ctrl" Key="B" Command="{Binding SidebarViewModel.BackupCommand}"/>
        <KeyBinding Modifiers="Ctrl" Key="P" Command="{Binding SidebarViewModel.PrintCommand}"/>
        <KeyBinding Modifiers="Alt" Key="F4" Command="{Binding SidebarViewModel.ExitCommand}"/>
    </Window.InputBindings>
        
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Themes/Base.xaml"/>
                <ResourceDictionary Source="Styles/SideNav.xaml"/>
                <ResourceDictionary Source="Styles/ComponentStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            
            <!-- محول الرؤية -->
            <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
            
            <!-- أنيميشن القائمة الجانبية -->
            <Storyboard x:Key="ShowSidebar">
                <DoubleAnimation Storyboard.TargetName="SidebarTransform" 
                               Storyboard.TargetProperty="X" 
                               To="0" Duration="0:0:0.35">
                    <DoubleAnimation.EasingFunction>
                        <CubicEase EasingMode="EaseOut"/>
                    </DoubleAnimation.EasingFunction>
                </DoubleAnimation>
                <DoubleAnimation Storyboard.TargetName="OverlayBorder" 
                               Storyboard.TargetProperty="Opacity" 
                               To="0.4" Duration="0:0:0.35"/>
            </Storyboard>
            
            <Storyboard x:Key="HideSidebar">
                <DoubleAnimation Storyboard.TargetName="SidebarTransform" 
                               Storyboard.TargetProperty="X" 
                               To="-380" Duration="0:0:0.35">
                    <DoubleAnimation.EasingFunction>
                        <CubicEase EasingMode="EaseOut"/>
                    </DoubleAnimation.EasingFunction>
                </DoubleAnimation>
                <DoubleAnimation Storyboard.TargetName="OverlayBorder" 
                               Storyboard.TargetProperty="Opacity" 
                               To="0" Duration="0:0:0.35"/>
            </Storyboard>
            
        </ResourceDictionary>
    </Window.Resources>

    <Grid>
        <!-- التخطيط الرئيسي -->
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>  <!-- الشريط العلوي -->
            <RowDefinition Height="Auto"/>  <!-- شريط القوائم -->
            <RowDefinition Height="*"/>     <!-- المحتوى مع القائمة الجانبية -->
            <RowDefinition Height="Auto"/>  <!-- شريط الحالة -->
        </Grid.RowDefinitions>

        <!-- الشريط العلوي المطور -->
        <Border Grid.Row="0" Background="{StaticResource HeaderGradient}" Height="65">
            <Grid Margin="25,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- زر القائمة الجانبية مع تصميم حديث -->
                <Button x:Name="btnToggleSidebar" 
                        Grid.Column="0"
                        Click="ToggleSidebar_Click"
                        Width="45" Height="45"
                        Background="#FFFFFF25"
                        BorderThickness="0"
                        Cursor="Hand"
                        VerticalAlignment="Center"
                        Margin="0,0,15,0">
                    <TextBlock Text="☰" FontSize="16" Foreground="White" FontWeight="Bold"/>
                </Button>
                
                <!-- العنوان الرئيسي المحسن -->
                <StackPanel Grid.Column="1" 
                           Orientation="Horizontal" 
                           HorizontalAlignment="Center" 
                           VerticalAlignment="Center">
                    <TextBlock Text="💼" FontSize="24" Margin="0,0,12,0" VerticalAlignment="Center"/>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="النظام المحاسبي الشامل" 
                                   FontSize="20" 
                                   FontWeight="Bold" 
                                   Foreground="White"/>
                        <TextBlock Text="لوحة التحكم الذكية - الإدارة المتطورة" 
                                   FontSize="11" 
                                   Foreground="#FFFFFFA0"/>
                    </StackPanel>
                </StackPanel>
                
                <!-- شريط المعلومات والأدوات -->
                <StackPanel Grid.Column="2" 
                           Orientation="Horizontal" 
                           VerticalAlignment="Center">
                    <!-- كل الشاشات -->
                    <Button x:Name="btnAllScreens"
                            Width="120" Height="40"
                            Background="#FFFFFF20"
                            BorderThickness="0"
                            Cursor="Hand"
                            Margin="8,0"
                            Click="btnAllScreens_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📚" FontSize="14" Foreground="White" Margin="0,0,5,0"/>
                            <TextBlock Text="كل الشاشات" FontSize="12" Foreground="White" FontWeight="Bold"/>
                        </StackPanel>
                    </Button>
                    
                    <!-- إشعارات -->
                    <Button x:Name="btnNotifications"
                            Width="40" Height="40"
                            Background="#FFFFFF15"
                            BorderThickness="0"
                            Cursor="Hand"
                            Margin="8,0"
                            Click="btnNotifications_Click">
                        <StackPanel>
                            <TextBlock Text="🔔" FontSize="14" Foreground="White" HorizontalAlignment="Center"/>
                            <TextBlock x:Name="lblNotificationCount" Text="3" FontSize="9" Foreground="#FF4CAF50" 
                                       HorizontalAlignment="Center" Margin="0,-2,0,0"/>
                        </StackPanel>
                    </Button>
                    
                    <!-- معلومات المستخدم -->
                    <Border Background="#FFFFFF20" 
                            CornerRadius="18" 
                            Padding="12,6" 
                            Margin="8,0">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="👤" FontSize="14" Margin="0,0,6,0" VerticalAlignment="Center"/>
                            <TextBlock x:Name="lblCurrentUser" 
                                       Text="المدير العام" 
                                       Foreground="White" 
                                       FontWeight="Medium"
                                       FontSize="12"
                                       VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- الوقت والتاريخ -->
                    <Border Background="#FFFFFF20" 
                            CornerRadius="18" 
                            Padding="12,6"
                            Margin="8,0">
                        <StackPanel>
                            <TextBlock x:Name="lblCurrentTime" 
                                       Text="12:30 PM" 
                                       Foreground="White"
                                       FontSize="11"
                                       FontWeight="SemiBold"
                                       HorizontalAlignment="Center"/>
                            <TextBlock x:Name="lblCurrentDate" 
                                       Text="الأحد 7 أكتوبر" 
                                       Foreground="#FFFFFFC0"
                                       FontSize="9"
                                       HorizontalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- إعدادات سريعة -->
                    <Button x:Name="btnQuickSettings"
                            Width="40" Height="40"
                            Background="#FFFFFF15"
                            BorderThickness="0"
                            Cursor="Hand"
                            Margin="8,0"
                            Click="btnQuickSettings_Click">
                        <TextBlock Text="⚙️" FontSize="14" Foreground="White"/>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- شريط القوائم المتطور -->
        <Border Grid.Row="1" Background="{StaticResource ModernWhite}" 
                BorderBrush="{StaticResource CardShadow}" 
                BorderThickness="0,0,0,1">
            <Menu Background="Transparent" 
                  FontFamily="Segoe UI, Tahoma" 
                  FontSize="13" 
                  FlowDirection="RightToLeft">
                
                <!-- ملف -->
                <MenuItem Header="📁 ملف" FontWeight="Bold">
                    <MenuItem Header="➕ جديد">
                        <MenuItem Header="عميل جديد" Click="mnuNewCustomer_Click" InputGestureText="Ctrl+Alt+C"/>
                        <MenuItem Header="مورد جديد" Click="mnuNewSupplier_Click" InputGestureText="Ctrl+Alt+S"/>
                        <MenuItem Header="منتج جديد" Click="mnuNewProduct_Click" InputGestureText="Ctrl+Alt+P"/>
                        <Separator/>
                        <MenuItem Header="فاتورة مبيعات" Click="mnuNewSalesInvoice_Click" InputGestureText="F2"/>
                        <MenuItem Header="فاتورة مشتريات" Click="mnuNewPurchaseInvoice_Click" InputGestureText="F3"/>
                    </MenuItem>
                    <Separator/>
                    <MenuItem Header="💾 نسخ احتياطي" Click="mnuBackup_Click" InputGestureText="Ctrl+B"/>
                    <MenuItem Header="📄 طباعة" Click="mnuPrint_Click" InputGestureText="Ctrl+P"/>
                    <Separator/>
                    <MenuItem Header="❌ خروج" Click="mnuExit_Click" InputGestureText="Alt+F4"/>
                </MenuItem>

                <!-- البيانات الأساسية -->
                <MenuItem Header="📂 البيانات الأساسية" FontWeight="Bold">
                    <MenuItem Header="👥 العملاء" Click="mnuCustomers_Click" InputGestureText="F5"/>
                    <MenuItem Header="🏢 الموردين" Click="mnuSuppliers_Click" InputGestureText="F6"/>
                    <Separator/>
                    <MenuItem Header="📦 المنتجات والخدمات" Click="mnuProducts_Click" InputGestureText="F7"/>
                    <MenuItem Header="🏷️ أصناف المنتجات" Click="mnuCategories_Click"/>
                    <MenuItem Header="📏 وحدات القياس" Click="mnuUnits_Click"/>
                    <MenuItem Header="🏪 المخازن" Click="mnuWarehouses_Click"/>
                </MenuItem>

                <!-- المبيعات -->
                <MenuItem Header="🛒 المبيعات" FontWeight="Bold">
                    <MenuItem Header="💰 نقطة البيع" Click="mnuPOS_Click" InputGestureText="F1" FontWeight="Bold"/>
                    <Separator/>
                    <MenuItem Header="📄 فاتورة مبيعات جديدة" Click="mnuNewSalesInvoice_Click" InputGestureText="F2"/>
                    <MenuItem Header="📋 جميع فواتير المبيعات" Click="mnuSalesInvoices_Click"/>
                    <MenuItem Header="📝 الفواتير المؤجلة" Click="mnuDraftInvoices_Click"/>
                    <Separator/>
                    <MenuItem Header="↩️ مرتجعات المبيعات" Click="mnuSalesReturns_Click"/>
                    <MenuItem Header="🔄 إدارة المرتجعات" Click="mnuReturnsManagement_Click"/>
                    <MenuItem Header="📊 عروض الأسعار" Click="mnuQuotations_Click"/>
                    <Separator/>
                    <MenuItem Header="🏷️ إدارة الخصومات" Click="mnuDiscountManagement_Click"/>
                    <MenuItem Header="⭐ برنامج الولاء" Click="mnuLoyaltyProgram_Click"/>
                </MenuItem>

                <!-- المشتريات -->
                <MenuItem Header="🛍️ المشتريات" FontWeight="Bold">
                    <MenuItem Header="📄 فاتورة مشتريات جديدة" Click="mnuNewPurchaseInvoice_Click" InputGestureText="F3"/>
                    <MenuItem Header="📋 جميع فواتير المشتريات" Click="mnuPurchaseInvoices_Click"/>
                    <Separator/>
                    <MenuItem Header="📑 أوامر الشراء" Click="mnuPurchaseOrders_Click"/>
                    <Separator/>
                    <MenuItem Header="↩️ مرتجعات المشتريات" Click="mnuPurchaseReturns_Click"/>
                    <MenuItem Header="🔄 إدارة المرتجعات" Click="mnuReturnsManagement_Click"/>
                </MenuItem>

                <!-- المخزون والجرد -->
                <MenuItem Header="📦 المخزون والجرد" FontWeight="Bold">
                    <MenuItem Header="📊 تقرير المخزون الحالي" Click="mnuStockReport_Click" InputGestureText="F8"/>
                    <MenuItem Header="🔄 حركات المخزن" Click="mnuStockMovements_Click"/>
                    <MenuItem Header="📱 قارئ الباركود" Click="mnuBarcodeReader_Click" FontWeight="Bold"/>
                    <Separator/>
                    <MenuItem Header="📋 الجرد الدوري" Click="mnuInventoryCount_Click"/>
                    <MenuItem Header="⚠️ تنبيهات المخزون" Click="mnuStockAlerts_Click"/>
                </MenuItem>

                <!-- الخزينة والمالية -->
                <MenuItem Header="💰 الخزينة والمالية" FontWeight="Bold">
                    <MenuItem Header="🏦 إدارة الخزائن" Click="mnuCashBoxes_Click" FontWeight="Bold"/>
                    <MenuItem Header="💸 حركات الخزينة" Click="mnuCashTransactions_Click"/>
                    <MenuItem Header="📊 تقرير الخزينة" Click="mnuCashReport_Click"/>
                    <Separator/>
                    <MenuItem Header="📥 سندات القبض" Click="mnuReceiptVouchers_Click"/>
                    <MenuItem Header="📤 سندات الصرف" Click="mnuPaymentVouchers_Click"/>
                    <MenuItem Header="↔️ تحويل نقدي" Click="mnuCashTransfer_Click"/>
                    <Separator/>
                    <MenuItem Header="🏛️ الحسابات البنكية" Click="mnuBankAccounts_Click"/>
                    <MenuItem Header="💳 الشيكات" Click="mnuChecks_Click"/>
                    <MenuItem Header="💸 إدارة المصروفات" Click="mnuExpenses_Click"/>
                </MenuItem>

                <!-- التقارير والأدوات -->
                <MenuItem Header="📊 التقارير" FontWeight="Bold">
                    <MenuItem Header="📈 التقارير العامة" Click="mnuReports_Click" FontWeight="Bold" InputGestureText="F9"/>
                    <MenuItem Header="💹 التحليل المالي" Click="mnuFinancialAnalysis_Click" FontWeight="Bold"/>
                    <Separator/>
                    <MenuItem Header="🛒 تقارير المبيعات" Click="mnuSalesReports_Click"/>
                    <MenuItem Header="📦 تقارير المخزون" Click="mnuInventoryReports_Click"/>
                    <MenuItem Header="👥 تقارير العملاء" Click="mnuCustomerReports_Click"/>
                    <MenuItem Header="🏢 تقارير الموردين" Click="mnuSupplierReports_Click"/>
                    <Separator/>
                    <MenuItem Header="📈 الرسوم البيانية" Click="mnuCharts_Click"/>
                </MenuItem>

                <!-- أدوات النظام -->
                <MenuItem Header="🔧 أدوات النظام" FontWeight="Bold">
                    <MenuItem Header="🖨️ قوالب الطباعة" Click="mnuPrintTemplates_Click"/>
                    <MenuItem Header="🖨️ الطباعة الحرارية" Click="mnuThermalPrinting_Click"/>
                    <Separator/>
                    <MenuItem Header="💾 النسخ والاستعادة" Click="mnuBackupRestore_Click"/>
                    <MenuItem Header="🔄 استيراد/تصدير بيانات" Click="mnuImportExport_Click"/>
                    <MenuItem Header="🔧 صيانة قاعدة البيانات" Click="mnuDatabaseMaintenance_Click"/>
                </MenuItem>

                <!-- الإعدادات -->
                <MenuItem Header="⚙️ الإعدادات" FontWeight="Bold">
                    <MenuItem Header="🛠️ إعدادات النظام" Click="mnuSystemSettings_Click" InputGestureText="F11"/>
                    <Separator/>
                    <MenuItem Header="👤 إدارة المستخدمين" Click="mnuUserManagement_Click"/>
                    <MenuItem Header="🔐 الصلاحيات" Click="mnuPermissions_Click"/>
                    <Separator/>
                    <MenuItem Header="🎨 تخصيص الواجهة" Click="mnuCustomizeInterface_Click"/>
                    <MenuItem Header="📊 مراقبة النظام" Click="mnuSystemMonitoring_Click"/>
                </MenuItem>

                <!-- المساعدة -->
                <MenuItem Header="❓ المساعدة" FontWeight="Bold">
                    <MenuItem Header="📖 دليل المستخدم" Click="mnuUserManual_Click" InputGestureText="F1"/>
                    <MenuItem Header="🎥 فيديوهات تعليمية" Click="mnuVideoTutorials_Click"/>
                    <Separator/>
                    <MenuItem Header="🔄 فحص التحديثات" Click="mnuCheckUpdates_Click"/>
                    <MenuItem Header="📞 الدعم التقني" Click="mnuTechnicalSupport_Click"/>
                    <Separator/>
                    <MenuItem Header="ℹ️ حول البرنامج" Click="mnuAbout_Click"/>
                </MenuItem>
            </Menu>
        </Border>

        <!-- المحتوى الرئيسي مع القائمة الجانبية -->
        <Grid Grid.Row="2">
            
            <!-- المحتوى الأساسي -->
            <ScrollViewer x:Name="MainScrollViewer" 
                          VerticalScrollBarVisibility="Auto" 
                          Background="{StaticResource ModernLight}"
                          Padding="20">
                
                <StackPanel>
                    
                    <!-- عنوان الترحيب -->
                    <StackPanel Margin="0,20,0,30">
                        <TextBlock Text="مرحباً بك في لوحة التحكم الذكية" 
                                   FontSize="32" 
                                   FontWeight="Bold" 
                                   Foreground="{StaticResource SidebarBackground}"/>
                        <TextBlock Text="إدارة شاملة ومتطورة لجميع عمليات الأعمال - تحكم كامل وذكي" 
                                   FontSize="16" 
                                   Foreground="{StaticResource ModernGray}" 
                                   Margin="0,8,0,0"/>
                    </StackPanel>

                    <!-- الإحصائيات السريعة -->
                    <WrapPanel Orientation="Horizontal" Margin="0,0,0,30">
                        
                        <Border Style="{StaticResource StatsCard}" Background="{StaticResource AccentGreen}">
                            <StackPanel>
                                <TextBlock Text="💰" FontSize="36" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                <TextBlock Text="إجمالي المبيعات" 
                                           FontSize="13" 
                                           Foreground="White" 
                                           HorizontalAlignment="Center" 
                                           FontWeight="Medium"/>
                                <TextBlock x:Name="lblTotalSales" 
                                           Text="125,500 ج.م" 
                                           FontSize="20" 
                                           FontWeight="Bold" 
                                           Foreground="White" 
                                           HorizontalAlignment="Center"
                                           Margin="0,5,0,0"/>
                                <TextBlock Text="هذا الشهر" 
                                           FontSize="11" 
                                           Foreground="#FFFFFFC0" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Style="{StaticResource StatsCard}" Background="{StaticResource PrimaryBlue}">
                            <StackPanel>
                                <TextBlock Text="📄" FontSize="36" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                <TextBlock Text="عدد الفواتير" 
                                           FontSize="13" 
                                           Foreground="White" 
                                           HorizontalAlignment="Center" 
                                           FontWeight="Medium"/>
                                <TextBlock x:Name="lblTotalInvoices" 
                                           Text="1,247" 
                                           FontSize="20" 
                                           FontWeight="Bold" 
                                           Foreground="White" 
                                           HorizontalAlignment="Center"
                                           Margin="0,5,0,0"/>
                                <TextBlock Text="هذا الشهر" 
                                           FontSize="11" 
                                           Foreground="#FFFFFFC0" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Style="{StaticResource StatsCard}" Background="{StaticResource AccentOrange}">
                            <StackPanel>
                                <TextBlock Text="👥" FontSize="36" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                <TextBlock Text="العملاء النشطين" 
                                           FontSize="13" 
                                           Foreground="White" 
                                           HorizontalAlignment="Center" 
                                           FontWeight="Medium"/>
                                <TextBlock x:Name="lblActiveCustomers" 
                                           Text="856" 
                                           FontSize="20" 
                                           FontWeight="Bold" 
                                           Foreground="White" 
                                           HorizontalAlignment="Center"
                                           Margin="0,5,0,0"/>
                                <TextBlock Text="عميل نشط" 
                                           FontSize="11" 
                                           Foreground="#FFFFFFC0" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Style="{StaticResource StatsCard}" Background="{StaticResource AccentRed}">
                            <StackPanel>
                                <TextBlock Text="⚠️" FontSize="36" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                <TextBlock Text="التنبيهات" 
                                           FontSize="13" 
                                           Foreground="White" 
                                           HorizontalAlignment="Center" 
                                           FontWeight="Medium"/>
                                <TextBlock x:Name="lblAlerts" 
                                           Text="23" 
                                           FontSize="20" 
                                           FontWeight="Bold" 
                                           Foreground="White" 
                                           HorizontalAlignment="Center"
                                           Margin="0,5,0,0"/>
                                <TextBlock Text="تنبيه مهم" 
                                           FontSize="11" 
                                           Foreground="#FFFFFFC0" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Style="{StaticResource StatsCard}" Background="{StaticResource AccentPurple}">
                            <StackPanel>
                                <TextBlock Text="📦" FontSize="36" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                <TextBlock Text="إجمالي المنتجات" 
                                           FontSize="13" 
                                           Foreground="White" 
                                           HorizontalAlignment="Center" 
                                           FontWeight="Medium"/>
                                <TextBlock Text="3,456" 
                                           FontSize="20" 
                                           FontWeight="Bold" 
                                           Foreground="White" 
                                           HorizontalAlignment="Center"
                                           Margin="0,5,0,0"/>
                                <TextBlock Text="منتج متاح" 
                                           FontSize="11" 
                                           Foreground="#FFFFFFC0" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Style="{StaticResource StatsCard}" Background="#2ECC71">
                            <StackPanel>
                                <TextBlock Text="💸" FontSize="36" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                <TextBlock Text="صافي الربح" 
                                           FontSize="13" 
                                           Foreground="White" 
                                           HorizontalAlignment="Center" 
                                           FontWeight="Medium"/>
                                <TextBlock Text="45,230 ج.م" 
                                           FontSize="20" 
                                           FontWeight="Bold" 
                                           Foreground="White" 
                                           HorizontalAlignment="Center"
                                           Margin="0,5,0,0"/>
                                <TextBlock Text="هذا الشهر" 
                                           FontSize="11" 
                                           Foreground="#FFFFFFC0" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        
                    </WrapPanel>

                    <!-- العمليات السريعة -->
                    <Border Background="{StaticResource ModernWhite}"
                            CornerRadius="12"
                            Padding="25"
                            Margin="0,0,0,25">
                        <StackPanel>
                            <TextBlock Text="🚀 العمليات السريعة" 
                                       FontSize="22" 
                                       FontWeight="Bold" 
                                       Foreground="{StaticResource SidebarBackground}" 
                                       Margin="0,0,0,20"/>
                            
                            <WrapPanel Orientation="Horizontal">
                                
                                <Button Style="{StaticResource QuickActionCard}" 
                                        Click="mnuNewSalesInvoice_Click">
                                    <StackPanel>
                                        <TextBlock Text="🛒" FontSize="40" HorizontalAlignment="Center"/>
                                        <TextBlock Text="فاتورة مبيعات" 
                                                   FontSize="14" 
                                                   FontWeight="Bold" 
                                                   HorizontalAlignment="Center" 
                                                   Margin="0,10,0,0"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button Style="{StaticResource QuickActionCard}" 
                                        Click="mnuPOS_Click">
                                    <StackPanel>
                                        <TextBlock Text="💰" FontSize="40" HorizontalAlignment="Center"/>
                                        <TextBlock Text="نقطة البيع" 
                                                   FontSize="14" 
                                                   FontWeight="Bold" 
                                                   HorizontalAlignment="Center" 
                                                   Margin="0,10,0,0"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button Style="{StaticResource QuickActionCard}" 
                                        Click="mnuProducts_Click">
                                    <StackPanel>
                                        <TextBlock Text="📦" FontSize="40" HorizontalAlignment="Center"/>
                                        <TextBlock Text="إدارة المنتجات" 
                                                   FontSize="14" 
                                                   FontWeight="Bold" 
                                                   HorizontalAlignment="Center" 
                                                   Margin="0,10,0,0"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button Style="{StaticResource QuickActionCard}" 
                                        Click="mnuCustomers_Click">
                                    <StackPanel>
                                        <TextBlock Text="👥" FontSize="40" HorizontalAlignment="Center"/>
                                        <TextBlock Text="إدارة العملاء" 
                                                   FontSize="14" 
                                                   FontWeight="Bold" 
                                                   HorizontalAlignment="Center" 
                                                   Margin="0,10,0,0"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button Style="{StaticResource QuickActionCard}" 
                                        Click="mnuNewPurchaseInvoice_Click">
                                    <StackPanel>
                                        <TextBlock Text="📥" FontSize="40" HorizontalAlignment="Center"/>
                                        <TextBlock Text="فاتورة شراء" 
                                                   FontSize="14" 
                                                   FontWeight="Bold" 
                                                   HorizontalAlignment="Center" 
                                                   Margin="0,10,0,0"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button Style="{StaticResource QuickActionCard}" 
                                        Click="mnuCashBoxes_Click">
                                    <StackPanel>
                                        <TextBlock Text="🏦" FontSize="40" HorizontalAlignment="Center"/>
                                        <TextBlock Text="إدارة الخزينة" 
                                                   FontSize="14" 
                                                   FontWeight="Bold" 
                                                   HorizontalAlignment="Center" 
                                                   Margin="0,10,0,0"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button Style="{StaticResource QuickActionCard}" 
                                        Click="mnuReports_Click">
                                    <StackPanel>
                                        <TextBlock Text="📊" FontSize="40" HorizontalAlignment="Center"/>
                                        <TextBlock Text="التقارير" 
                                                   FontSize="14" 
                                                   FontWeight="Bold" 
                                                   HorizontalAlignment="Center" 
                                                   Margin="0,10,0,0"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button Style="{StaticResource QuickActionCard}" 
                                        Click="mnuSettings_Click">
                                    <StackPanel>
                                        <TextBlock Text="⚙️" FontSize="40" HorizontalAlignment="Center"/>
                                        <TextBlock Text="إعدادات النظام" 
                                                   FontSize="14" 
                                                   FontWeight="Bold" 
                                                   HorizontalAlignment="Center" 
                                                   Margin="0,10,0,0"/>
                                    </StackPanel>
                                </Button>
                                
                            </WrapPanel>
                        </StackPanel>
                    </Border>

                    <!-- الرسوم البيانية -->
                    <Grid Margin="0,0,0,25">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- الرسم البياني الأول -->
                        <Border Grid.Column="0" 
                                Background="{StaticResource ModernWhite}"
                                CornerRadius="12"
                                Padding="20"
                                Margin="0,0,10,0">
                            <StackPanel>
                                <TextBlock Text="📈 المبيعات الشهرية" 
                                           FontSize="18" 
                                           FontWeight="Bold" 
                                           Foreground="{StaticResource SidebarBackground}" 
                                           HorizontalAlignment="Center"
                                           Margin="0,0,0,15"/>
                                
                                <Border Background="#F8F9FA" 
                                        CornerRadius="8" 
                                        Height="200" 
                                        Margin="0,10">
                                    <TextBlock Text="الرسم البياني للمبيعات الشهرية سيتم عرضه هنا"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"
                                               Foreground="{StaticResource ModernGray}"
                                               FontStyle="Italic"/>
                                </Border>
                            </StackPanel>
                        </Border>
                        
                        <!-- الرسم البياني الثاني -->
                        <Border Grid.Column="1" 
                                Background="{StaticResource ModernWhite}"
                                CornerRadius="12"
                                Padding="20"
                                Margin="10,0,0,0">
                            <StackPanel>
                                <TextBlock Text="📊 تحليل الأرباح" 
                                           FontSize="18" 
                                           FontWeight="Bold" 
                                           Foreground="{StaticResource SidebarBackground}" 
                                           HorizontalAlignment="Center"
                                           Margin="0,0,0,15"/>
                                
                                <Border Background="#F8F9FA" 
                                        CornerRadius="8" 
                                        Height="200" 
                                        Margin="0,10">
                                    <TextBlock Text="الرسم البياني لتحليل الأرباح سيتم عرضه هنا"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"
                                               Foreground="{StaticResource ModernGray}"
                                               FontStyle="Italic"/>
                                </Border>
                            </StackPanel>
                        </Border>
                        
                    </Grid>

                    <!-- آخر النشاطات -->
                    <Border Background="{StaticResource ModernWhite}"
                            CornerRadius="12"
                            Padding="25">
                        <StackPanel>
                            <TextBlock Text="📈 آخر النشاطات" 
                                       FontSize="20" 
                                       FontWeight="Bold" 
                                       Foreground="{StaticResource SidebarBackground}" 
                                       Margin="0,0,0,20"/>
                            
                            <ListView x:Name="lvRecentActivities" 
                                      MaxHeight="250" 
                                      BorderThickness="0"
                                      Background="Transparent">
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn Header="النوع" Width="150"/>
                                        <GridViewColumn Header="الوصف" Width="300"/>
                                        <GridViewColumn Header="التاريخ" Width="150"/>
                                        <GridViewColumn Header="المبلغ" Width="120"/>
                                        <GridViewColumn Header="الحالة" Width="100"/>
                                    </GridView>
                                </ListView.View>
                            </ListView>
                        </StackPanel>
                    </Border>
                    
                </StackPanel>
            </ScrollViewer>

            <!-- طبقة التراكب للقائمة الجانبية -->
            <Border x:Name="OverlayBorder" 
                   Background="Black" 
                   Opacity="0" 
                   Visibility="Collapsed"
                   MouseLeftButtonDown="OverlayBorder_MouseLeftButtonDown"/>

            <!-- القائمة الجانبية MVVM المطورة -->
            <Border x:Name="SidebarBorder" 
                   Width="380" 
                   Background="{StaticResource SidebarBrush}"
                   HorizontalAlignment="Left"
                   Panel.ZIndex="999"
                   FlowDirection="RightToLeft">
                <Border.RenderTransform>
                    <TranslateTransform x:Name="SidebarTransform" X="-380"/>
                </Border.RenderTransform>
                <Border.Effect>
                    <DropShadowEffect ShadowDepth="-5" BlurRadius="30" Color="Black" Opacity="0.4"/>
                </Border.Effect>

                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        
                        <!-- رأس القائمة -->
                        <Border Background="{StaticResource SecondaryBrush}" Padding="20,15">
                            <Grid>
                                <StackPanel HorizontalAlignment="Right">
                                    <TextBlock Text="القائمة الرئيسية" 
                                              FontFamily="Segoe UI, Tahoma"
                                              FontSize="18" FontWeight="Bold" 
                                              Foreground="White"/>
                                    <TextBlock Text="النظام المحاسبي الشامل" 
                                              FontFamily="Segoe UI, Tahoma"
                                              FontSize="12" 
                                              Foreground="#B0FFFFFF" 
                                              Margin="0,5,0,0"/>
                                </StackPanel>
                                <Button x:Name="btnCloseSidebar" 
                                       Click="btnCloseSidebar_Click"
                                       Width="30" Height="30"
                                       HorizontalAlignment="Left"
                                       Background="Transparent"
                                       BorderThickness="0"
                                       Cursor="Hand"
                                       Margin="0">
                                    <TextBlock Text="✕" FontSize="16" Foreground="White"/>
                                </Button>
                            </Grid>
                        </Border>

                        <!-- البحث السريع -->
                        <Border Background="#FFFFFF15" 
                                CornerRadius="8" 
                                Margin="15,15,15,15" 
                                Padding="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="txtSidebarSearch" 
                                         Grid.Column="0"
                                         Background="Transparent" 
                                         BorderThickness="0" 
                                         Foreground="White" 
                                         FontSize="13"
                                         Text="بحث سريع..."
                                         GotFocus="txtSidebarSearch_GotFocus"
                                         LostFocus="txtSidebarSearch_LostFocus"/>
                                <Button Grid.Column="1" 
                                        Background="Transparent" 
                                        BorderThickness="0" 
                                        Click="btnSidebarSearch_Click"
                                        Width="30" Height="25">
                                    <TextBlock Text="🔍" Foreground="White" FontSize="12"/>
                                </Button>
                            </Grid>
                        </Border>

                        <!-- قائمة التنقل MVVM -->
                        <ItemsControl ItemsSource="{Binding SidebarViewModel.MenuItems}" Margin="0,0,0,15">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <!-- قالب المجموعة -->
                                    <StackPanel Visibility="{Binding IsGroup, Converter={StaticResource BoolToVisibilityConverter}}">
                                        <!-- عنوان المجموعة -->
                                        <TextBlock Text="{Binding Title}" 
                                                   FontWeight="Bold" 
                                                   Foreground="#B0FFFFFF" 
                                                   Margin="15,15,15,5" 
                                                   FontSize="13"/>
                                        
                                        <!-- عناصر المجموعة -->
                                        <ItemsControl ItemsSource="{Binding Children}">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Button Style="{StaticResource SideNavButton}"
                                                            Command="{Binding NavigateCommand}">
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            
                                                            <!-- أيقونة -->
                                                            <ContentPresenter Grid.Column="0" 
                                                                            Content="{Binding IconKey, Converter={StaticResource IconKeyToVisualConverter}}" 
                                                                            Margin="0,0,10,0"/>
                                                            
                                                            <!-- النص -->
                                                            <TextBlock Grid.Column="1" 
                                                                     Text="{Binding Title}" 
                                                                     VerticalAlignment="Center"/>
                                                            
                                                            <!-- اختصار لوحة المفاتيح -->
                                                            <TextBlock Grid.Column="2" 
                                                                     Text="{Binding Shortcut}" 
                                                                     FontSize="10" 
                                                                     Foreground="#FFFFFFA0" 
                                                                     VerticalAlignment="Center"
                                                                     Margin="10,0,0,0"
                                                                     Visibility="{Binding Shortcut, Converter={StaticResource InverseBoolToVisibilityConverter}}"/>
                                                        </Grid>
                                                    </Button>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </StackPanel>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                            <!-- إحصائيات سريعة في الأسفل -->
                            <Border Background="#FFFFFF10" 
                                    CornerRadius="8" 
                                    Margin="15,20,15,10" 
                                    Padding="15">
                                <StackPanel>
                                    <TextBlock Text="📊 إحصائيات اليوم" 
                                               FontWeight="Bold" 
                                               Foreground="White" 
                                               FontSize="13" 
                                               HorizontalAlignment="Center" 
                                               Margin="0,0,0,10"/>
                                    
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBlock Grid.Row="0" Grid.Column="0" 
                                                   Text="المبيعات:" 
                                                   Foreground="#FFFFFFC0" 
                                                   FontSize="11"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" 
                                                   x:Name="lblSidebarSales" 
                                                   Text="12,500 ج.م" 
                                                   Foreground="#4FC3F7" 
                                                   FontSize="11" 
                                                   FontWeight="Bold"/>
                                        
                                        <TextBlock Grid.Row="1" Grid.Column="0" 
                                                   Text="الفواتير:" 
                                                   Foreground="#FFFFFFC0" 
                                                   FontSize="11"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" 
                                                   x:Name="lblSidebarInvoices" 
                                                   Text="25" 
                                                   Foreground="#90EE90" 
                                                   FontSize="11" 
                                                   FontWeight="Bold"/>
                                        
                                        <TextBlock Grid.Row="2" Grid.Column="0" 
                                                   Text="العملاء:" 
                                                   Foreground="#FFFFFFC0" 
                                                   FontSize="11"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" 
                                                   x:Name="lblSidebarCustomers" 
                                                   Text="8" 
                                                   Foreground="#87CEEB" 
                                                   FontSize="11" 
                                                   FontWeight="Bold"/>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- مساحة إضافية في الأسفل -->
                            <Border Height="30"/>
                        
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>

        <!-- شريط الحالة المطور -->
        <StatusBar Grid.Row="3" 
                   Background="{StaticResource ModernWhite}" 
                   BorderBrush="{StaticResource CardShadow}"
                   BorderThickness="0,1,0,0"
                   Height="35"
                   FlowDirection="RightToLeft">
            <StatusBarItem>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="🟢" FontSize="12" Margin="0,0,5,0"/>
                    <TextBlock x:Name="lblStatus" Text="النظام جاهز" FontSize="12"/>
                </StackPanel>
            </StatusBarItem>
            <StatusBarItem>
                <StackPanel Orientation="Horizontal" Margin="20,0">
                    <TextBlock Text="👤 المستخدم: " FontSize="11" Foreground="{StaticResource ModernGray}"/>
                    <TextBlock x:Name="lblStatusUser" Text="المدير العام" FontSize="11" FontWeight="Bold"/>
                </StackPanel>
            </StatusBarItem>
            <StatusBarItem>
                <StackPanel Orientation="Horizontal" Margin="20,0">
                    <TextBlock Text="📊 الذاكرة: " FontSize="11" Foreground="{StaticResource ModernGray}"/>
                    <TextBlock x:Name="lblMemoryUsage" Text="75%" FontSize="11" FontWeight="Bold"/>
                </StackPanel>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Left">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="🔌 قاعدة البيانات: " FontSize="11" Foreground="{StaticResource ModernGray}"/>
                    <TextBlock x:Name="lblConnectionStatus" 
                               Text="متصل" 
                               Foreground="Green" 
                               FontSize="11"
                               FontWeight="Bold"/>
                    <TextBlock Text="📶 الشبكة: " FontSize="11" Foreground="{StaticResource ModernGray}" Margin="15,0,0,0"/>
                    <TextBlock x:Name="lblNetworkStatus" 
                               Text="متصل" 
                               Foreground="Green" 
                               FontSize="11"
                               FontWeight="Bold"/>
                </StackPanel>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>