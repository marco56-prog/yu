<Window x:Class="AccountingSystem.WPF.Views.InventoryReportsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="طھظ‚ط±ظٹط± ط§ظ„ظ…ط®ط²ظˆظ†"
        Height="700" Width="1200"
        Style="{StaticResource StandardWindow}"
        WindowState="Maximized">

    <Window.Resources>
        <!-- ط§ط³طھط®ط¯ط§ظ… ط§ظ„ط£ظ†ظ…ط§ط· ط§ظ„ظ…ظˆط­ط¯ط© ظ…ط¹ ط§ظ„طھط®طµظٹطµ -->
        <Style TargetType="DataGridRow" BasedOn="{StaticResource {x:Type DataGridRow}}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsOutOfStock}" Value="True">
                    <Setter Property="Background" Value="{StaticResource DangerBrush}"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding IsLowStock}" Value="True">
                    <Setter Property="Background" Value="{StaticResource WarningBrush}"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- ط§ظ„ط¹ظ†ظˆط§ظ† -->
        <TextBlock Grid.Row="0" Text="طھظ‚ط±ظٹط± ط§ظ„ظ…ط®ط²ظˆظ†"
                   FontSize="{StaticResource FontSizeTitle}" FontWeight="Bold"
                   HorizontalAlignment="Center"
                   Foreground="{StaticResource PrimaryColor}" Margin="0,0,0,20"/>

        <!-- ظپظ„ط§طھط± ط§ظ„طھظ‚ط±ظٹط± -->
        <Border Grid.Row="1" Background="{StaticResource SurfaceBrush}" CornerRadius="8" Padding="10" BorderBrush="{StaticResource BorderColor}" BorderThickness="1">
            <Grid Margin="5">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="220"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="220"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" Text="ط§ظ„ظپط¦ط©:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <ComboBox Grid.Column="1" x:Name="cmbCategory" DisplayMemberPath="CategoryName" Height="30" Margin="0,0,15,0"/>

                <CheckBox Grid.Column="2" x:Name="chkLowStockOnly" Content="ط§ظ„ظ…ظ†طھط¬ط§طھ ظ†ط§ظ‚طµط© ط§ظ„ظ…ط®ط²ظˆظ† ظپظ‚ط·"
                          VerticalAlignment="Center" Margin="0,0,15,0"/>

                <TextBox Grid.Column="3" x:Name="txtSearch" Height="30" VerticalContentAlignment="Center"
                         Margin="0,0,15,0" Tag="ط¨ط­ط« ط¨ط§ظ„ط§ط³ظ… ط£ظˆ ط§ظ„ظƒظˆط¯..."
                         TextChanged="txtSearch_TextChanged"/>

                <TextBlock Grid.Column="4" x:Name="lblLoading" Text="âڈ³ ط¬ط§ط±ظٹ ط§ظ„طھط­ظ…ظٹظ„..."
                           Foreground="{StaticResource TextMutedColor}" VerticalAlignment="Center" Visibility="Collapsed"/>

                <Button Grid.Column="5" x:Name="btnGenerate" Content="طھظˆظ„ظٹط¯ ط§ظ„طھظ‚ط±ظٹط±"
                        Style="{StaticResource ButtonStyle}"
                        Click="btnGenerate_Click"/>
            </Grid>
        </Border>

        <!-- ط¥ط­طµط§ط¦ظٹط§طھ ط³ط±ظٹط¹ط© -->
        <Border Grid.Row="2" Background="{StaticResource SurfaceBrush}" CornerRadius="8" Padding="10" Margin="0,10,0,10" BorderBrush="{StaticResource BorderColor}" BorderThickness="1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                    <TextBlock Text="ظ‚ظٹظ…ط© ط§ظ„ظ…ط®ط²ظˆظ† ط§ظ„ط¥ط¬ظ…ط§ظ„ظٹط©" FontWeight="Bold" HorizontalAlignment="Center"/>
                    <TextBlock x:Name="lblTotalValue" Text="0.00 ط¬.ظ…" FontSize="{StaticResource FontSizeLarge}" FontWeight="Bold"
                               HorizontalAlignment="Center" Foreground="{StaticResource SuccessColor}"/>
                </StackPanel>

                <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                    <TextBlock Text="ط¹ط¯ط¯ ط§ظ„ظ…ظ†طھط¬ط§طھ" FontWeight="Bold" HorizontalAlignment="Center"/>
                    <TextBlock x:Name="lblTotalProducts" Text="0" FontSize="{StaticResource FontSizeLarge}" FontWeight="Bold"
                               HorizontalAlignment="Center" Foreground="{StaticResource PrimaryColor}"/>
                </StackPanel>

                <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                    <TextBlock Text="ظ…ظ†طھط¬ط§طھ ظ†ط§ظ‚طµط© ط§ظ„ظ…ط®ط²ظˆظ†" FontWeight="Bold" HorizontalAlignment="Center"/>
                    <TextBlock x:Name="lblLowStock" Text="0" FontSize="{StaticResource FontSizeLarge}" FontWeight="Bold"
                               HorizontalAlignment="Center" Foreground="{StaticResource WarningColor}"/>
                </StackPanel>

                <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                    <TextBlock Text="ظ…ظ†طھط¬ط§طھ ظ†ظپط¯طھ ظ…ظ† ط§ظ„ظ…ط®ط²ظˆظ†" FontWeight="Bold" HorizontalAlignment="Center"/>
                    <TextBlock x:Name="lblOutOfStock" Text="0" FontSize="{StaticResource FontSizeLarge}" FontWeight="Bold"
                               HorizontalAlignment="Center" Foreground="{StaticResource DangerColor}"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ط¬ط¯ظˆظ„ ط§ظ„طھظ‚ط±ظٹط± -->
        <Border Grid.Row="3" Background="{StaticResource SurfaceBrush}" CornerRadius="8" BorderBrush="{StaticResource BorderColor}" BorderThickness="1">
            <DataGrid x:Name="dgInventory"
                      ItemsSource="{Binding InventoryView}"
                      AutoGenerateColumns="False"
                      IsReadOnly="True"
                      AlternatingRowBackground="{StaticResource BackgroundBrush}"
                      GridLinesVisibility="Horizontal"
                      HorizontalGridLinesBrush="{StaticResource BorderColor}"
                      CanUserSortColumns="True"
                      EnableRowVirtualization="True"
                      EnableColumnVirtualization="True"
                      HeadersVisibility="Column">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="ظƒظˆط¯ ط§ظ„ظ…ظ†طھط¬" Binding="{Binding ProductCode}" Width="110"/>
                    <DataGridTextColumn Header="ط§ط³ظ… ط§ظ„ظ…ظ†طھط¬" Binding="{Binding ProductName}" Width="230"/>
                    <DataGridTextColumn Header="ط§ظ„ظپط¦ط©" Binding="{Binding CategoryName}" Width="140"/>
                    <DataGridTextColumn Header="ط§ظ„ظˆط­ط¯ط©" Binding="{Binding UnitName}" Width="90"/>

                    <DataGridTextColumn Header="ط§ظ„ظ…ط®ط²ظˆظ† ط§ظ„ط­ط§ظ„ظٹ" Width="120"
                                        Binding="{Binding CurrentStock, StringFormat={}{0:N2}}">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsOutOfStock}" Value="True">
                                        <Setter Property="Foreground" Value="{StaticResource DangerBrush}"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding IsLowStock}" Value="True">
                                        <Setter Property="Foreground" Value="{StaticResource WarningBrush}"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <DataGridTextColumn Header="ط§ظ„ط­ط¯ ط§ظ„ط£ط¯ظ†ظ‰" Width="110"
                                        Binding="{Binding MinimumStock, StringFormat={}{0:N2}}">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="HorizontalAlignment" Value="Center"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <DataGridTextColumn Header="ط³ط¹ط± ط§ظ„ط´ط±ط§ط،" Width="120"
                                        Binding="{Binding PurchasePrice, StringFormat={}{0:C}}">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="HorizontalAlignment" Value="Center"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <DataGridTextColumn Header="ط³ط¹ط± ط§ظ„ط¨ظٹط¹" Width="120"
                                        Binding="{Binding SalePrice, StringFormat={}{0:C}}">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="HorizontalAlignment" Value="Center"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <DataGridTextColumn Header="ظ‚ظٹظ…ط© ط§ظ„ظ…ط®ط²ظˆظ†" Width="140"
                                        Binding="{Binding InventoryValue, StringFormat={}{0:C}}">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                <Setter Property="FontWeight" Value="Bold"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <DataGridTextColumn Header="ط§ظ„ط­ط§ظ„ط©" Binding="{Binding Status}" Width="120">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsOutOfStock}" Value="True">
                                        <Setter Property="Foreground" Value="Red"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding IsLowStock}" Value="True">
                                        <Setter Property="Foreground" Value="Orange"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                </DataGrid.Columns>
            </DataGrid>
        </Border>

        <!-- ط£ط²ط±ط§ط± ط§ظ„طھط­ظƒظ… -->
        <StackPanel Grid.Row="4" Orientation="Horizontal"
                    HorizontalAlignment="Center" Margin="0,20,0,0">
            <Button x:Name="btnExportExcel" Content="طھطµط¯ظٹط± ط¥ظ„ظ‰ Excel"
                    Style="{StaticResource ButtonStyle}"
                    Click="btnExportExcel_Click"/>
            <Button x:Name="btnPrint" Content="ط·ط¨ط§ط¹ط©"
                    Style="{StaticResource ButtonStyle}"
                    Click="btnPrint_Click"/>
            <Button x:Name="btnClose" Content="ط¥ط؛ظ„ط§ظ‚"
                    Style="{StaticResource SecondaryButton}"
                    Click="btnClose_Click"/>
        </StackPanel>
    </Grid>
</Window>

