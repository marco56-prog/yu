<Window x:Class="AccountingSystem.WPF.Views.InvoicePrintPreview"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="معاينة الفاتورة - طباعة" Height="900" Width="750"
        FlowDirection="RightToLeft"
        WindowStartupLocation="CenterScreen"
    WindowState="Maximized"
        MinWidth="750" MinHeight="900">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- محتوى الفاتورة للطباعة -->
        <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
            <Border Name="InvoiceBorder" Background="White" Padding="30" Margin="10">
                <Grid Name="InvoiceContent" Width="680">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <!-- رأس الشركة -->
                        <RowDefinition Height="Auto"/>
                        <!-- معلومات الفاتورة -->
                        <RowDefinition Height="Auto"/>
                        <!-- معلومات العميل -->
                        <RowDefinition Height="Auto"/>
                        <!-- الرصيد السابق -->
                        <RowDefinition Height="*"/>
                        <!-- تفاصيل الأصناف -->
                        <RowDefinition Height="Auto"/>
                        <!-- الإجماليات -->
                        <RowDefinition Height="Auto"/>
                        <!-- التوقيعات -->
                    </Grid.RowDefinitions>

                    <!-- رأس الشركة -->
                    <Border Grid.Row="0" BorderBrush="Black" BorderThickness="0,0,0,2" Padding="0,0,0,15" Margin="0,0,0,15">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                <TextBlock Text="شركة المحاسبة المتقدمة" FontSize="22" FontWeight="Bold" HorizontalAlignment="Center" Foreground="DarkBlue"/>
                                <TextBlock Text="العنوان: شارع الجمهورية - القاهرة | الهاتف: 01234567890" FontSize="12" HorizontalAlignment="Center" Margin="0,5,0,0"/>
                                <TextBlock Text="البريد الإلكتروني: info@accounting.com | الموقع: www.accounting.com" FontSize="11" HorizontalAlignment="Center"/>
                            </StackPanel>

                            <Border Grid.Column="1" BorderBrush="DarkBlue" BorderThickness="2" Width="70" Height="70" VerticalAlignment="Center">
                                <Grid>
                                    <Rectangle Fill="LightBlue" Opacity="0.3"/>
                                    <TextBlock Text="LOGO" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="DarkBlue"/>
                                </Grid>
                            </Border>
                        </Grid>
                    </Border>

                    <!-- معلومات الفاتورة -->
                    <Border Grid.Row="1" BorderBrush="DarkGreen" BorderThickness="2" Padding="10" Margin="0,0,0,8" CornerRadius="5">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0">
                                <TextBlock Text="🧾 فاتورة بيع" FontSize="16" FontWeight="Bold" Foreground="DarkGreen" HorizontalAlignment="Center"/>
                                <StackPanel Orientation="Horizontal" Margin="0,3,0,0" HorizontalAlignment="Center">
                                    <TextBlock Text="رقم الفاتورة: " FontWeight="Bold" FontSize="12"/>
                                    <TextBlock Name="lblInvoiceNumber" Text="INV-001" FontSize="12" FontWeight="Bold" Foreground="DarkRed"/>
                                </StackPanel>
                            </StackPanel>

                            <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,3">
                                    <TextBlock Text="التاريخ: " FontWeight="Bold" FontSize="12"/>
                                    <TextBlock Name="lblInvoiceDate" Text="2025/09/20" FontSize="12"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="الوقت: " FontWeight="Bold" FontSize="12"/>
                                    <TextBlock Name="lblInvoiceTime" Text="12:30 م" FontSize="12"/>
                                </StackPanel>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- معلومات العميل -->
                    <Border Grid.Row="2" BorderBrush="DarkBlue" BorderThickness="1" Padding="8" Margin="0,0,0,8" CornerRadius="3">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0">
                                <TextBlock Text="👤 بيانات العميل" FontWeight="Bold" FontSize="12" Foreground="DarkBlue" Margin="0,0,0,3"/>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,2">
                                    <TextBlock Text="الاسم: " FontWeight="Bold" Width="60" FontSize="11"/>
                                    <TextBlock Name="lblCustomerName" Text="اسم العميل" FontSize="11"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="الهاتف: " FontWeight="Bold" Width="60" FontSize="11"/>
                                    <TextBlock Name="lblCustomerPhone" Text="01234567890" FontSize="11"/>
                                </StackPanel>
                            </StackPanel>

                            <StackPanel Grid.Column="1">
                                <TextBlock Text="📍 العنوان" FontWeight="Bold" FontSize="12" Foreground="DarkBlue" Margin="0,0,0,3"/>
                                <TextBlock Name="lblCustomerAddress" Text="عنوان العميل" TextWrapping="Wrap" FontSize="11" Height="30"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- الرصيد السابق -->
                    <Border Grid.Row="3" BorderBrush="Purple" BorderThickness="1" Padding="8" Margin="0,0,0,8" Background="#FFFAF0" CornerRadius="3">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                <TextBlock Text="💰 الرصيد السابق" FontWeight="Bold" FontSize="10" Foreground="Purple"/>
                                <TextBlock Name="lblPreviousBalance" Text="0.00 ج.م" FontWeight="Bold" FontSize="12" HorizontalAlignment="Center"/>
                            </StackPanel>

                            <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                <TextBlock Text="🧮 هذه الفاتورة" FontWeight="Bold" FontSize="10" Foreground="Green"/>
                                <TextBlock Name="lblCurrentInvoiceTotal" Text="0.00 ج.م" FontWeight="Bold" FontSize="12" HorizontalAlignment="Center"/>
                            </StackPanel>

                            <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                                <TextBlock Text="📊 الإجمالي الكلي" FontWeight="Bold" FontSize="10" Foreground="Red"/>
                                <TextBlock Name="lblGrandTotal" Text="0.00 ج.م" FontWeight="Bold" FontSize="12" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- تفاصيل الأصناف -->
                    <Border Grid.Row="4" BorderBrush="Black" BorderThickness="1" Margin="0,0,0,8">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- عنوان الجدول -->
                            <Grid Grid.Row="0" Background="#E6E6FA">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="30"/>
                                    <!-- م -->
                                    <ColumnDefinition Width="*"/>
                                    <!-- الصنف -->
                                    <ColumnDefinition Width="60"/>
                                    <!-- الوحدة -->
                                    <ColumnDefinition Width="50"/>
                                    <!-- الكمية -->
                                    <ColumnDefinition Width="60"/>
                                    <!-- السعر -->
                                    <ColumnDefinition Width="70"/>
                                    <!-- الإجمالي -->
                                    <ColumnDefinition Width="50"/>
                                    <!-- الخصم -->
                                    <ColumnDefinition Width="70"/>
                                    <!-- الصافي -->
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Column="0" Text="م" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center" Padding="3" FontSize="11"/>
                                <Border Grid.Column="0" BorderBrush="Black" BorderThickness="0,0,1,0"/>

                                <TextBlock Grid.Column="1" Text="الصنف" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center" Padding="3" FontSize="11"/>
                                <Border Grid.Column="1" BorderBrush="Black" BorderThickness="0,0,1,0"/>

                                <TextBlock Grid.Column="2" Text="الوحدة" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center" Padding="3" FontSize="11"/>
                                <Border Grid.Column="2" BorderBrush="Black" BorderThickness="0,0,1,0"/>

                                <TextBlock Grid.Column="3" Text="الكمية" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center" Padding="3" FontSize="11"/>
                                <Border Grid.Column="3" BorderBrush="Black" BorderThickness="0,0,1,0"/>

                                <TextBlock Grid.Column="4" Text="السعر" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center" Padding="3" FontSize="11"/>
                                <Border Grid.Column="4" BorderBrush="Black" BorderThickness="0,0,1,0"/>

                                <TextBlock Grid.Column="5" Text="الإجمالي" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center" Padding="3" FontSize="11"/>
                                <Border Grid.Column="5" BorderBrush="Black" BorderThickness="0,0,1,0"/>

                                <TextBlock Grid.Column="6" Text="الخصم" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center" Padding="3" FontSize="11"/>
                                <Border Grid.Column="6" BorderBrush="Black" BorderThickness="0,0,1,0"/>

                                <TextBlock Grid.Column="7" Text="الصافي" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center" Padding="3" FontSize="11"/>
                            </Grid>

                            <!-- محتوى الجدول -->
                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" MaxHeight="300">
                                <ItemsControl Name="InvoiceItemsControl">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border BorderBrush="Black" BorderThickness="0,0,0,1">
                                                <Grid MinHeight="25">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="30"/>
                                                        <!-- م -->
                                                        <ColumnDefinition Width="*"/>
                                                        <!-- الصنف -->
                                                        <ColumnDefinition Width="60"/>
                                                        <!-- الوحدة -->
                                                        <ColumnDefinition Width="50"/>
                                                        <!-- الكمية -->
                                                        <ColumnDefinition Width="60"/>
                                                        <!-- السعر -->
                                                        <ColumnDefinition Width="70"/>
                                                        <!-- الإجمالي -->
                                                        <ColumnDefinition Width="50"/>
                                                        <!-- الخصم -->
                                                        <ColumnDefinition Width="70"/>
                                                        <!-- الصافي -->
                                                    </Grid.ColumnDefinitions>

                                                    <TextBlock Grid.Column="0" Text="{Binding ItemNumber}" HorizontalAlignment="Center" VerticalAlignment="Center" Padding="3" FontSize="10"/>
                                                    <Border Grid.Column="0" BorderBrush="Black" BorderThickness="0,0,1,0"/>

                                                    <TextBlock Grid.Column="1" Text="{Binding ProductName}" VerticalAlignment="Center" Padding="3" TextWrapping="Wrap" FontSize="10"/>
                                                    <Border Grid.Column="1" BorderBrush="Black" BorderThickness="0,0,1,0"/>

                                                    <TextBlock Grid.Column="2" Text="{Binding UnitName}" HorizontalAlignment="Center" VerticalAlignment="Center" Padding="3" FontSize="10"/>
                                                    <Border Grid.Column="2" BorderBrush="Black" BorderThickness="0,0,1,0"/>

                                                    <TextBlock Grid.Column="3" Text="{Binding Quantity, StringFormat=N2}" HorizontalAlignment="Center" VerticalAlignment="Center" Padding="3" FontSize="10"/>
                                                    <Border Grid.Column="3" BorderBrush="Black" BorderThickness="0,0,1,0"/>

                                                    <TextBlock Grid.Column="4" Text="{Binding UnitPrice, StringFormat=N2}" HorizontalAlignment="Center" VerticalAlignment="Center" Padding="3" FontSize="10"/>
                                                    <Border Grid.Column="4" BorderBrush="Black" BorderThickness="0,0,1,0"/>

                                                    <TextBlock Grid.Column="5" Text="{Binding TotalPrice, StringFormat=N2}" HorizontalAlignment="Center" VerticalAlignment="Center" Padding="3" FontSize="10"/>
                                                    <Border Grid.Column="5" BorderBrush="Black" BorderThickness="0,0,1,0"/>

                                                    <TextBlock Grid.Column="6" Text="{Binding DiscountAmount, StringFormat=N2}" HorizontalAlignment="Center" VerticalAlignment="Center" Padding="3" FontSize="10"/>
                                                    <Border Grid.Column="6" BorderBrush="Black" BorderThickness="0,0,1,0"/>

                                                    <TextBlock Grid.Column="7" Text="{Binding NetAmount, StringFormat=N2}" HorizontalAlignment="Center" VerticalAlignment="Center" Padding="3" FontWeight="Bold" FontSize="10"/>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                        </Grid>
                    </Border>

                    <!-- الإجماليات -->
                    <Border Grid.Row="5" BorderBrush="Black" BorderThickness="1" Padding="10" Margin="0,0,0,8" CornerRadius="3">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="200"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0">
                                <TextBlock Text="💡 ملاحظات:" FontWeight="Bold" FontSize="11" Margin="0,0,0,3"/>
                                <Border BorderBrush="Gray" BorderThickness="1" Padding="5" Height="60" CornerRadius="2" Width="415">
                                    <TextBlock Name="lblNotes" Text="شكراً لتعاملكم معنا - نتمنى لكم التوفيق" TextWrapping="Wrap" FontStyle="Italic" FontSize="10" VerticalAlignment="Top"/>
                                </Border>
                            </StackPanel>

                            <StackPanel Grid.Column="1">
                                <Grid Margin="0,0,0,3">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="الإجمالي الفرعي:" FontWeight="Bold" FontSize="11"/>
                                    <TextBlock Grid.Column="1" Name="lblSubTotal" Text="0.00 ج.م" HorizontalAlignment="Right" FontSize="11"/>
                                </Grid>

                                <Grid Margin="0,0,0,3">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="إجمالي الخصم:" FontWeight="Bold" FontSize="11"/>
                                    <TextBlock Grid.Column="1" Name="lblTotalDiscount" Text="0.00 ج.م" HorizontalAlignment="Right" FontSize="11"/>
                                </Grid>

                                <Grid Margin="0,0,0,3">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="الضرائب:" FontWeight="Bold" FontSize="11"/>
                                    <TextBlock Grid.Column="1" Name="lblTax" Text="0.00 ج.م" HorizontalAlignment="Right" FontSize="11"/>
                                </Grid>

                                <Border BorderBrush="Black" BorderThickness="0,1,0,0" Padding="0,5,0,0" Margin="0,3,0,0">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="80"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="الصافي النهائي:" FontWeight="Bold" FontSize="12"/>
                                        <TextBlock Grid.Column="1" Name="lblNetTotal" Text="0.00 ج.م" HorizontalAlignment="Right" FontWeight="Bold" FontSize="12" Foreground="DarkRed"/>
                                    </Grid>
                                </Border>

                                <Grid Margin="0,8,0,3">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="المبلغ المدفوع:" FontWeight="Bold" FontSize="11"/>
                                    <TextBlock Grid.Column="1" Name="lblPaidAmount" Text="0.00 ج.م" HorizontalAlignment="Right" FontSize="11" Foreground="Green"/>
                                </Grid>

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="المبلغ المتبقي:" FontWeight="Bold" FontSize="11"/>
                                    <TextBlock Grid.Column="1" Name="lblRemainingAmount" Text="0.00 ج.م" HorizontalAlignment="Right" Foreground="Red" FontSize="11"/>
                                </Grid>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- التوقيعات -->
                    <Grid Grid.Row="6" Margin="0,15,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                            <TextBlock Text="توقيع المحاسب" FontWeight="Bold" HorizontalAlignment="Center" FontSize="11"/>
                            <Border BorderBrush="Black" BorderThickness="0,0,0,1" Width="100" Height="40" Margin="0,8,0,0"/>
                            <TextBlock Text="الاسم: ________________" FontSize="9" HorizontalAlignment="Center" Margin="0,5,0,0"/>
                        </StackPanel>

                        <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                            <TextBlock Text="توقيع العميل" FontWeight="Bold" HorizontalAlignment="Center" FontSize="11"/>
                            <Border BorderBrush="Black" BorderThickness="0,0,0,1" Width="100" Height="40" Margin="0,8,0,0"/>
                            <TextBlock Text="الاسم: ________________" FontSize="9" HorizontalAlignment="Center" Margin="0,5,0,0"/>
                        </StackPanel>

                        <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                            <TextBlock Text="ختم الشركة" FontWeight="Bold" HorizontalAlignment="Center" FontSize="11"/>
                            <Border BorderBrush="Black" BorderThickness="1" Width="60" Height="60" Margin="0,8,0,0" CornerRadius="30">
                                <TextBlock Text="SEAL" FontSize="9" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="Gray"/>
                            </Border>
                        </StackPanel>
                    </Grid>
                </Grid>
            </Border>
        </ScrollViewer>

        <!-- أزرار التحكم -->
        <Border Grid.Row="1" BorderBrush="LightGray" BorderThickness="0,1,0,0" Padding="15" Background="#F8F8FF">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                <Button Name="btnPrint" Content="🖨️ طباعة مباشرة" Width="130" Height="40" Margin="8"
                        Background="#4CAF50" Foreground="White" Click="btnPrint_Click"
                        FontWeight="Bold" FontSize="12"/>
                <Button Name="btnPrintPreview" Content="👁️ معاينة متقدمة" Width="130" Height="40" Margin="8"
                        Background="#2196F3" Foreground="White" Click="btnPrintPreview_Click"
                        FontWeight="Bold" FontSize="12"/>
                <Button Name="btnSaveAsPdf" Content="📄 حفظ PDF" Width="130" Height="40" Margin="8"
                        Background="#FF9800" Foreground="White" Click="btnSaveAsPdf_Click"
                        FontWeight="Bold" FontSize="12"/>
                <!-- أزرار التنقل -->
                <Button Name="btnPrevious" Content="⬅️ السابق" Width="100" Height="40" Margin="8"
                        Background="#9C27B0" Foreground="White" Click="btnPrevious_Click"
                        FontWeight="Bold" FontSize="11" ToolTip="الفاتورة السابقة"/>
                <Button Name="btnNext" Content="التالي ➡️" Width="100" Height="40" Margin="8"
                        Background="#9C27B0" Foreground="White" Click="btnNext_Click"
                        FontWeight="Bold" FontSize="11" ToolTip="الفاتورة التالية"/>
                <Button Name="btnClose" Content="❌ إغلاق" Width="100" Height="40" Margin="8"
                        Background="#757575" Foreground="White" Click="btnClose_Click"
                        FontWeight="Bold" FontSize="12"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>
