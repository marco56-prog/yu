<Window x:Class="AccountingSystem.WPF.Views.PrintPreviewWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© - Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©" 
        Height="800" Width="1200"
        FlowDirection="RightToLeft"
        FontFamily="Segoe UI"
        Background="#F8F9FA"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Ø±Ø£Ø³ Ø§Ù„Ù†Ø§ÙØ°Ø© -->
        <Border Grid.Row="0" Background="#2E86AB" Padding="15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock Text="ðŸ‘ï¸" FontSize="24" Margin="0,0,10,0" VerticalAlignment="Center"/>
                    <TextBlock Text="Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©" FontSize="20" FontWeight="Bold" 
                              Foreground="White" VerticalAlignment="Center"/>
                </StackPanel>

                <!-- Ø´Ø±ÙŠØ· Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center">
                    <Button x:Name="btnPrint" Content="ðŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©" Width="100" Height="35"
                           Background="#28A745" Foreground="White" FontWeight="Bold" 
                           Margin="5" Click="btnPrint_Click"/>
                    
                    <Button x:Name="btnSaveAsPdf" Content="ðŸ“„ Ø­ÙØ¸ PDF" Width="100" Height="35"
                           Background="#DC3545" Foreground="White" FontWeight="Bold" 
                           Margin="5" Click="btnSaveAsPdf_Click"/>
                    
                    <Button x:Name="btnClose" Content="âœ–ï¸ Ø¥ØºÙ„Ø§Ù‚" Width="100" Height="35"
                           Background="#6C757D" Foreground="White" FontWeight="Bold" 
                           Margin="5" Click="btnClose_Click"/>
                </StackPanel>

                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ù„Ø¨ -->
                <StackPanel Grid.Column="2" Orientation="Vertical" HorizontalAlignment="Right">
                    <TextBlock x:Name="lblTemplateName" Text="Ø§Ø³Ù… Ø§Ù„Ù‚Ø§Ù„Ø¨" 
                              Foreground="White" FontWeight="Bold" FontSize="14"/>
                    <TextBlock x:Name="lblTemplateType" Text="Ù†ÙˆØ¹ Ø§Ù„Ù‚Ø§Ù„Ø¨" 
                              Foreground="LightGray" FontSize="12"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="250"/>
            </Grid.ColumnDefinitions>

            <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© -->
            <Border Grid.Column="0" Background="White" Margin="10" 
                   BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="8">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Ø´Ø±ÙŠØ· Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© -->
                    <Border Grid.Row="0" Background="#F8F9FA" Padding="10" 
                           BorderBrush="#E0E0E0" BorderThickness="0,0,0,1">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" Text="ðŸ“‹ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯" 
                                      FontSize="16" FontWeight="Bold" VerticalAlignment="Center"/>

                            <!-- Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø¹Ø±Ø¶ -->
                            <StackPanel Grid.Column="1" Orientation="Horizontal">
                                <TextBlock Text="Ø§Ù„ØªÙƒØ¨ÙŠØ±:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <Slider x:Name="zoomSlider" Width="120" Minimum="0.25" Maximum="3.0" 
                                       Value="1.0" VerticalAlignment="Center" 
                                       TickPlacement="BottomRight" TickFrequency="0.25"/>
                                <TextBlock Text="{Binding Value, ElementName=zoomSlider, StringFormat={}{0:P0}}" 
                                          VerticalAlignment="Center" Margin="10,0,0,0" MinWidth="50"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Ø¹Ø§Ø±Ø¶ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ -->
                    <ScrollViewer Grid.Row="1" x:Name="previewScrollViewer" 
                                 HorizontalScrollBarVisibility="Auto" 
                                 VerticalScrollBarVisibility="Auto" Padding="20">
                        
                        <Grid Background="#F5F5F5">
                            <!-- ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¸Ù„ Ù„Ù„ØµÙØ­Ø© -->
                            <Border Background="#DDDDDD" CornerRadius="3" Margin="5,5,0,0"/>
                            
                            <!-- Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
                            <Border Background="White" BorderBrush="#CCCCCC" BorderThickness="1" 
                                   CornerRadius="3" MinWidth="794" MinHeight="1123">
                                <Border.Effect>
                                    <DropShadowEffect ShadowDepth="3" Color="#AAAAAA" BlurRadius="8"/>
                                </Border.Effect>
                                
                                <!-- Ù…Ù†Ø·Ù‚Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ -->
                                <DocumentViewer x:Name="documentViewer" 
                                               Background="Transparent" 
                                               BorderThickness="0"/>
                            </Border>
                        </Grid>
                        
                        <ScrollViewer.LayoutTransform>
                            <ScaleTransform ScaleX="{Binding Value, ElementName=zoomSlider}" 
                                          ScaleY="{Binding Value, ElementName=zoomSlider}"/>
                        </ScrollViewer.LayoutTransform>
                    </ScrollViewer>
                </Grid>
            </Border>

            <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ - Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© -->
            <Border Grid.Column="1" Background="White" Margin="0,10,10,10" 
                   BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="8" Padding="15">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ù„Ø¨ -->
                        <Border Background="#F8F9FA" Padding="15" CornerRadius="5" Margin="0,0,0,15">
                            <StackPanel>
                                <TextBlock Text="â„¹ï¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ù„Ø¨" FontSize="16" FontWeight="Bold" 
                                          HorizontalAlignment="Center" Margin="0,0,0,15"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Ø§Ù„Ø§Ø³Ù…:" 
                                              FontWeight="Bold" Margin="0,0,10,8"/>
                                    <TextBlock Grid.Row="0" Grid.Column="1" x:Name="lblDetailTemplateName" 
                                              TextWrapping="Wrap" Margin="0,0,0,8"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Ø§Ù„Ù†ÙˆØ¹:" 
                                              FontWeight="Bold" Margin="0,0,10,8"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1" x:Name="lblDetailTemplateType" 
                                              Margin="0,0,0,8"/>

                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Ø­Ø¬Ù… Ø§Ù„ØµÙØ­Ø©:" 
                                              FontWeight="Bold" Margin="0,0,10,8"/>
                                    <TextBlock Grid.Row="2" Grid.Column="1" x:Name="lblPageSize" 
                                              Margin="0,0,0,8"/>

                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Ø§Ù„Ø¹Ù†Ø§ØµØ±:" 
                                              FontWeight="Bold" Margin="0,0,10,0"/>
                                    <TextBlock Grid.Row="3" Grid.Column="1" x:Name="lblElementsCount"/>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© -->
                        <Border Background="#F8F9FA" Padding="15" CornerRadius="5" Margin="0,0,0,15">
                            <StackPanel>
                                <TextBlock Text="âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©" FontSize="14" FontWeight="Bold" 
                                          HorizontalAlignment="Center" Margin="0,0,0,15"/>

                                <CheckBox Content="Ø·Ø¨Ø§Ø¹Ø© Ù…Ù„ÙˆÙ†Ø©" IsChecked="True" Margin="0,0,0,10"/>
                                <CheckBox Content="Ø·Ø¨Ø§Ø¹Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ¬Ù‡ÙŠÙ†" Margin="0,0,0,10"/>
                                <CheckBox Content="Ù…Ù„Ø§Ø¦Ù…Ø© Ù„Ù„ØµÙØ­Ø©" Margin="0,0,0,10"/>

                                <StackPanel Margin="0,10,0,0">
                                    <TextBlock Text="Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ø³Ø®:" FontWeight="Bold" Margin="0,0,0,5"/>
                                    <TextBox x:Name="txtCopies" Text="1" Height="25" 
                                            VerticalContentAlignment="Center"/>
                                </StackPanel>

                                <StackPanel Margin="0,10,0,0">
                                    <TextBlock Text="Ø¬ÙˆØ¯Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©:" FontWeight="Bold" Margin="0,0,0,5"/>
                                    <ComboBox x:Name="cmbPrintQuality" Height="25">
                                        <ComboBoxItem Content="Ø¹Ø§Ø¯ÙŠØ© (150 DPI)" Tag="150"/>
                                        <ComboBoxItem Content="Ø¹Ø§Ù„ÙŠØ© (300 DPI)" IsSelected="True" Tag="300"/>
                                        <ComboBoxItem Content="Ø¹Ø§Ù„ÙŠØ© Ø¬Ø¯Ø§Ù‹ (600 DPI)" Tag="600"/>
                                    </ComboBox>
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <!-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª PDF -->
                        <Border Background="#F8F9FA" Padding="15" CornerRadius="5" Margin="0,0,0,15">
                            <StackPanel>
                                <TextBlock Text="ðŸ“„ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª PDF" FontSize="14" FontWeight="Bold" 
                                          HorizontalAlignment="Center" Margin="0,0,0,15"/>

                                <CheckBox x:Name="chkIncludeBookmarks" Content="ØªØ¶Ù…ÙŠÙ† Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„Ù…Ø±Ø¬Ø¹ÙŠØ©" Margin="0,0,0,8"/>
                                <CheckBox x:Name="chkOptimizeForWeb" Content="ØªØ­Ø³ÙŠÙ† Ù„Ù„ÙˆÙŠØ¨" IsChecked="True" Margin="0,0,0,8"/>
                                <CheckBox x:Name="chkPasswordProtection" Content="Ø­Ù…Ø§ÙŠØ© Ø¨ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±" Margin="0,0,0,8"/>

                                <StackPanel x:Name="passwordPanel" Visibility="Collapsed" Margin="0,8,0,0">
                                    <TextBlock Text="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:" FontWeight="Bold" Margin="0,0,0,5"/>
                                    <PasswordBox x:Name="txtPdfPassword" Height="25"/>
                                </StackPanel>

                                <StackPanel Margin="0,10,0,0">
                                    <TextBlock Text="Ø¬ÙˆØ¯Ø© Ø§Ù„Ø¶ØºØ·:" FontWeight="Bold" Margin="0,0,0,5"/>
                                    <ComboBox x:Name="cmbPdfQuality" Height="25">
                                        <ComboBoxItem Content="Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø©" IsSelected="True"/>
                                        <ComboBoxItem Content="Ù…ØªÙˆØ³Ø·Ø©"/>
                                        <ComboBoxItem Content="Ù…Ø¶ØºÙˆØ·Ø©"/>
                                    </ComboBox>
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© -->
                        <Border Background="#E8F5E8" Padding="15" CornerRadius="5">
                            <StackPanel>
                                <TextBlock Text="ðŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª" FontSize="14" FontWeight="Bold" 
                                          HorizontalAlignment="Center" Margin="0,0,0,15"/>

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Ø§Ù„ØµÙØ­Ø§Øª:" 
                                              FontWeight="Bold" Margin="0,0,0,8"/>
                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="1" 
                                              HorizontalAlignment="Center" Margin="0,0,0,8"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Ø§Ù„Ø¹Ù†Ø§ØµØ±:" 
                                              FontWeight="Bold" Margin="0,0,0,8"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1" x:Name="lblStatsElements" Text="0" 
                                              HorizontalAlignment="Center" Margin="0,0,0,8"/>

                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Ø§Ù„Ù†ØµÙˆØµ:" 
                                              FontWeight="Bold" Margin="0,0,0,8"/>
                                    <TextBlock Grid.Row="2" Grid.Column="1" x:Name="lblStatsTexts" Text="0" 
                                              HorizontalAlignment="Center" Margin="0,0,0,8"/>

                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„:" 
                                              FontWeight="Bold"/>
                                    <TextBlock Grid.Row="3" Grid.Column="1" x:Name="lblStatsTables" Text="0" 
                                              HorizontalAlignment="Center"/>
                                </Grid>

                                <Separator Margin="0,15" Background="#CCCCCC"/>
                                
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock Text="Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…ØªÙˆÙ‚Ø¹: " FontWeight="Bold"/>
                                    <TextBlock Text="~125 KB" Foreground="#28A745"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <!-- Ù†ØµØ§Ø¦Ø­ ÙˆØ¥Ø±Ø´Ø§Ø¯Ø§Øª -->
                        <Border Background="#FFF3CD" BorderBrush="#FFEAA7" BorderThickness="1" 
                               Padding="15" CornerRadius="5" Margin="0,15,0,0">
                            <StackPanel>
                                <TextBlock Text="ðŸ’¡ Ù†ØµØ§Ø¦Ø­" FontSize="12" FontWeight="Bold" 
                                          HorizontalAlignment="Center" Margin="0,0,0,10"/>
                                
                                <TextBlock TextWrapping="Wrap" FontSize="11" Foreground="#856404">
                                    <Run Text="â€¢ Ø§Ø³ØªØ®Ø¯Ù… Ctrl+P Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø³Ø±ÙŠØ¹Ø©"/>
                                    <LineBreak/>
                                    <Run Text="â€¢ PDF Ø£ÙØ¶Ù„ Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ© ÙˆØ§Ù„Ø£Ø±Ø´ÙØ©"/>
                                    <LineBreak/>
                                    <Run Text="â€¢ ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©"/>
                                </TextBlock>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>

        <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø­Ø§Ù„Ø© -->
        <StatusBar Grid.Row="2" Background="#F8F9FA" BorderBrush="#E0E0E0" BorderThickness="0,1,0,0">
            <StatusBar.ItemsPanel>
                <ItemsPanelTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                    </Grid>
                </ItemsPanelTemplate>
            </StatusBar.ItemsPanel>
            
            <StatusBarItem Grid.Column="0">
                <TextBlock x:Name="lblStatus" Text="Ø¬Ø§Ù‡Ø² Ù„Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©" Foreground="#6C757D"/>
            </StatusBarItem>
            
            <StatusBarItem Grid.Column="1">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: " Foreground="#6C757D"/>
                    <TextBlock x:Name="lblLastUpdate" Text="" FontWeight="Bold" Foreground="#2E86AB"/>
                </StackPanel>
            </StatusBarItem>
            
            <StatusBarItem Grid.Column="2">
                <TextBlock Text="Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© v1.0" Foreground="#6C757D"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>

    <!-- Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ -->
    <Window.InputBindings>
        <KeyBinding Key="P" Modifiers="Ctrl" Command="{Binding PrintCommand}"/>
        <KeyBinding Key="S" Modifiers="Ctrl" Command="{Binding SaveCommand}"/>
        <KeyBinding Key="Escape" Command="{Binding CloseCommand}"/>
    </Window.InputBindings>
</Window>
