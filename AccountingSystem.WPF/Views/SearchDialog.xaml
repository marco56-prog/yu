<Window x:Class="AccountingSystem.WPF.Views.SearchDialogBase"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="ط¨ط­ط«"
        Height="500" Width="800" MinHeight="350" MinWidth="600"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        FlowDirection="RightToLeft"
        FontFamily="Segoe UI, Tahoma"
        FontSize="{StaticResource FontSizeSmall}"
        PreviewKeyDown="Window_PreviewKeyDown"
        Background="{DynamicResource BackgroundBrush}">

    <!-- ================= ط§ط®طھطµط§ط±ط§طھ ط§ظ„ظƒظٹط¨ظˆط±ط¯ ================= -->
    <Window.InputBindings>
        <KeyBinding Key="Enter" Command="{x:Static ApplicationCommands.Save}"/>
        <KeyBinding Key="Escape" Command="{x:Static ApplicationCommands.Close}"/>
        <KeyBinding Key="F3" Command="{x:Static ApplicationCommands.Find}"/>
    </Window.InputBindings>

    <!-- ================= ظ…ظˆط§ط±ط¯ ظ…ط­ظ„ظٹط© ================= -->
    <Window.Resources>
        <!-- ط£ظ†ظ…ط§ط· ظ„ظ„ط­ظ‚ظˆظ„ -->
        <Style x:Key="SearchTextBoxStyle" TargetType="TextBox" BasedOn="{StaticResource ModernTextBox}">
            <Setter Property="FontSize" Value="{StaticResource FontSizeNormal}"/>
            <Setter Property="Padding" Value="10,8"/>
        </Style>

        <Style x:Key="ResultsDataGridStyle" TargetType="DataGrid" BasedOn="{StaticResource ModernDataGrid}">
            <Setter Property="AlternatingRowBackground" Value="{StaticResource BackgroundBrush}"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="CanUserAddRows" Value="False"/>
            <Setter Property="CanUserDeleteRows" Value="False"/>
            <Setter Property="IsReadOnly" Value="True"/>
            <Setter Property="SelectionMode" Value="Single"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
        </Style>

        <!-- ط´ط§ط±ط© ط§ظ„ط¹ط¯ط¯ -->
        <Style x:Key="CountBadge" TargetType="Border">
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Background" Value="{StaticResource InfoBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource InfoBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <!-- طھظ„ظ…ظٹط­ ط§ظ„ط§ط®طھطµط§ط±ط§طھ -->
        <Style x:Key="ShortcutHint" TargetType="TextBlock">
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="Foreground" Value="{StaticResource MutedBrush}"/>
            <Setter Property="Margin" Value="4,0,0,0"/>
        </Style>
    </Window.Resources>

    <!-- ================= طھط®ط·ظٹط· ط§ظ„ظ†ط§ظپط°ط© ================= -->
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- ========== ط´ط±ظٹط· ط§ظ„ط¹ظ†ظˆط§ظ† ظˆط§ظ„ط¨ط­ط« ========== -->
        <Border Grid.Row="0" Background="{DynamicResource PrimaryBrush}" CornerRadius="8,8,0,0" Padding="16,12" Margin="0,0,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- ط§ظ„ط¹ظ†ظˆط§ظ† -->
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock x:Name="lblTitle" Text="ط¨ط­ط«" FontSize="{StaticResource FontSizeNormal}" FontWeight="Bold" Foreground="White" VerticalAlignment="Center"/>
                    <TextBlock Text="ًں”چ" FontSize="16" Foreground="White" Margin="8,0,0,0" VerticalAlignment="Center"/>
                </StackPanel>

                <!-- ط¹ط¯ط§ط¯ ط§ظ„ظ†طھط§ط¦ط¬ -->
                <Border Grid.Column="1" Style="{StaticResource CountBadge}" Background="White" BorderBrush="White">
                    <TextBlock x:Name="lblItemCount" Text="ط¹ط¯ط¯ ط§ظ„ط¹ظ†ط§طµط±: 0" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}"/>
                </Border>
            </Grid>
        </Border>

        <!-- ========== ط­ظ‚ظ„ ط§ظ„ط¨ط­ط« ========== -->
        <Border Grid.Row="1" Background="{DynamicResource SurfaceBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1,0,1,0" Padding="16,12">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBox x:Name="txtSearch" 
                         Grid.Column="0"
                         Style="{StaticResource SearchTextBoxStyle}"
                         Background="White"
                         BorderBrush="{StaticResource BorderColor}"
                         BorderThickness="2"
                         VerticalAlignment="Center"
                         TextChanged="txtSearch_TextChanged"
                         MaxLength="100"/>

                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="12,0,0,0">
                    <Button x:Name="btnClearSearch" Content="âœ—"
                            Style="{StaticResource SecondaryButton}"
                            Width="30" Height="30"
                            ToolTip="ظ…ط³ط­ ط§ظ„ط¨ط­ط«"
                            Click="ClearSearch"
                            FontWeight="Bold"/>
                    <TextBlock Text="Esc" Style="{StaticResource ShortcutHint}" VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ========== ط¬ط¯ظˆظ„ ط§ظ„ظ†طھط§ط¦ط¬ ========== -->
        <Border Grid.Row="2" Background="{DynamicResource SurfaceBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1,0,1,0" Padding="0">
            <DataGrid x:Name="dgResults"
                      Style="{StaticResource ResultsDataGridStyle}"
                      MouseDoubleClick="dgResults_MouseDoubleClick"
                      SelectionChanged="dgResults_SelectionChanged"
                      FontSize="{StaticResource FontSizeSmall}"
                      RowHeight="28"
                      ColumnHeaderHeight="32"
                      Margin="0">
                
                <!-- ط³ظٹطھظ… ط¥ظ†ط´ط§ط، ط§ظ„ط£ط¹ظ…ط¯ط© ط¨ط±ظ…ط¬ظٹط§ظ‹ -->
                
            </DataGrid>
        </Border>

        <!-- ========== ط´ط±ظٹط· ط§ظ„ظ…ط³ط§ط¹ط¯ط© ظˆط§ظ„ط§ط®طھطµط§ط±ط§طھ ========== -->
        <Border Grid.Row="3" Background="{DynamicResource BackgroundBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1,0,1,0" Padding="16,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- ط±ط³ط§ظ„ط© ط§ظ„ط­ط§ظ„ط© -->
                <TextBlock x:Name="lblStatus" 
                           Grid.Column="0"
                           Text="ط§ظƒطھط¨ ظ„ظ„ط¨ط­ط« ط£ظˆ ط§ط³طھط®ط¯ظ… ط§ظ„ط£ط³ظ‡ظ… ظ„ظ„طھطµظپط­"
                           Foreground="{StaticResource MutedColor}"
                           VerticalAlignment="Center"/>

                <!-- طھظ„ظ…ظٹط­ط§طھ ط§ظ„ط§ط®طھطµط§ط±ط§طھ -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="â†‘â†“ طھظ†ظ‚ظ„" Style="{StaticResource ShortcutHint}"/>
                    <TextBlock Text="Enter ط§ط®طھظٹط§ط±" Style="{StaticResource ShortcutHint}"/>
                    <TextBlock Text="F3 ط§ظ„طھط§ظ„ظٹ" Style="{StaticResource ShortcutHint}"/>
                    <TextBlock Text="PgUp/Dn طµظپط­ط©" Style="{StaticResource ShortcutHint}"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ========== ط£ط²ط±ط§ط± ط§ظ„طھط­ظƒظ… ========== -->
        <Border Grid.Row="4" Background="{DynamicResource SurfaceBrush}" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" CornerRadius="0,0,8,8" Padding="16,12">
            <DockPanel LastChildFill="False">
                <!-- ط£ط²ط±ط§ط± ظٹط³ط§ط± -->
                <StackPanel DockPanel.Dock="Right" Orientation="Horizontal">
                    <Button x:Name="btnCancel" Content="âœ— ط¥ظ„ط؛ط§ط،"
                            Style="{StaticResource SecondaryButton}" 
                            Click="btnCancel_Click" 
                            IsCancel="True"/>
                </StackPanel>

                <!-- ط£ط²ط±ط§ط± ط±ط¦ظٹط³ظٹط© -->
                <StackPanel DockPanel.Dock="Left" Orientation="Horizontal">
                    <Button x:Name="btnOK" Content="âœ… ط§ط®طھظٹط§ط±"
                            Style="{StaticResource PrimaryButtonStyle}" 
                            Click="btnOK_Click" 
                            IsDefault="True" 
                            IsEnabled="False"/>
                </StackPanel>

                <!-- ظ…ط¹ظ„ظˆظ…ط§طھ ط¥ط¶ط§ظپظٹط© -->
                <TextBlock DockPanel.Dock="Bottom" 
                           Text="ًں’، ظ†طµظٹط­ط©: ط§ظƒطھط¨ ط¬ط²ط،ط§ظ‹ ظ…ظ† ط§ظ„ط§ط³ظ… ط£ظˆ ط§ظ„ظƒظˆط¯ ظ„ظ„ط¨ط­ط« ط§ظ„ط³ط±ظٹط¹"
                           FontSize="10" 
                           Foreground="{StaticResource MutedColor}" 
                           HorizontalAlignment="Center" 
                           Margin="0,8,0,0"/>
            </DockPanel>
        </Border>
    </Grid>
</Window>
